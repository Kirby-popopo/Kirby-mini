<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Instagram 회원가입</title>
    <link rel="stylesheet" href="signup.css">
    <style>
        .error-message{
            display: none;
            color: red;
            margin-top: 10px;
            transition: opacity 0.5s ease-in-out;
        }

        .error-message.show {
            display: block;
            opacity: 1;
        }
        .input-container {
            position: relative;
            margin-bottom: 20px;
        }

        input[type="text"] {
            width: 100%;
            padding: 10px 5px;
            font-size: 16px;
            box-sizing: border-box;
        }

        label {
            position: absolute;
            left: 10px;
            top: 12px;
            transition: all 0.3s ease;  /* 부드러운 전환 효과 */
            background-color: white;  /* 입력 필드 위에 있을 때 배경색을 설정 */
            padding: 0 5px;
            font-size: 16px;
            color: gray;
        }
        /* 입력 필드가 포커스를 받거나 입력 값이 있을 때 라벨을 위로 이동 */
        input:focus + label,
        input:not(:placeholder-shown) + label {
            top: -10px;  /* 라벨을 위로 이동 */
            font-size: 12px;  /* 글자 크기 줄이기 */
            color: #007BFF;  /* 포커스 상태에서 색상 변경 */
        }
        .gender-container {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }

        .gender-container label {
            display: flex;
            align-items: center;
            cursor: pointer;
            position: relative;
        }

        input[type="radio"] {
            display: none;  /* 기본 라디오 버튼 숨기기 */
        }

        .custom-radio {
            width: 16px;
            height: 16px;
            border: 2px solid #007BFF; /* 라디오 버튼 외곽선 */
            border-radius: 50%;  /* 둥근 모양 */
            margin-right: 10px;  /* 라벨과 간격 조정 */
            position: relative;
        }

        input[type="radio"]:checked + .custom-radio {
            background-color: #007BFF;  /* 체크된 경우 배경색 */
            border-color: #007BFF;
        }

        input[type="radio"]:checked + .custom-radio::after {
            content: "";
            width: 8px;
            height: 8px;
            background-color: white;  /* 내부 점 색상 */
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            border-radius: 50%;
        }
    </style>
</head>
<body>
<div class="signup-container">
    <div class="logo">Instagram</div>
    <div class="subtitle">친구들의 사진과 동영상을 보려면 가입하세요.</div>
    <form id="signupForm" action="/signup/join" method="post">

        <!--번호 또는 이메일-->
        <div class="input-container">
            <input type="text" id="UserInput" name="UserInput" placeholder="" required>
            <label for="UserInput">휴대폰 번호 또는 이메일 주소</label>
            <div id="userError" class="error-message"></div>
        </div>
        <input type="hidden" id="phoneNumber" name="phoneNumber">
        <input type="hidden" id="email" name="email">

        <!--사용자 ID-->
        <div class="input-container">
            <input type="text" id="userid" name="userId" placeholder="" required>
            <label for="name">사용자 ID</label>
        </div>

        <!--사용자 이름-->
        <div class="input-container">
            <input type="text" id="name" name="username" placeholder="" required>
            <label for="name">사용자 이름</label>
        </div>

        <!--성별-->
        <div class="gender-container">
            <label for="male">
                <input type="radio" id="male" name="gender" value="M" required>
                <span class="custom-radio"></span> 남성
            </label>
            <label for="female">
                <input type="radio" id="female" name="gender" value="F" required>
                <span class="custom-radio"></span> 여성
            </label>
        </div>

        <!--별명-->
        <div class="input-container">
            <input type="text" id="nickname" name="nickname" placeholder="" required>
            <label for="nickname">별명</label>
        </div>

        <div id="emailError" class="error"></div>
        <div id="usernameError" class="error"></div>
        <div id="usernameSuggestions" class="username-suggestions"></div>

        <div class="password-container">
            <input type="password" id="password" name="userPw" placeholder="비밀번호" required>
            <button type="button" id="passwordToggle" class="password-toggle">표시</button>
        </div>
        <div id="passwordError" class="error"></div>

        <button type="submit" >가입</button>
    </form>
</div>

<script>
    const form = document.getElementById('signupForm');
    const userInputField = document.getElementById('UserInput');
    const emailField = document.getElementById('email');
    const phoneNumberField = document.getElementById('phoneNumber');
    const username = document.getElementById('username');
    const password = document.getElementById('password');
    const passwordToggle = document.getElementById('passwordToggle');
    const userError = document.getElementById('userError');
    const usernameError = document.getElementById('usernameError');
    const passwordError = document.getElementById('passwordError');
    const usernameSuggestions = document.getElementById('usernameSuggestions');

    // 입력 필드에서 입력이 발생할 때마다 유효성 검사 수행
    userInputField.addEventListener('input', validateUserInput);
    userInputField.addEventListener('blur', validateUserInput);
    password.addEventListener('input', validatePassword);

    passwordToggle.addEventListener('click', function() {
        if (password.type === 'password') {
            password.type = 'text';
            passwordToggle.textContent = '숨기기';
        } else {
            password.type = 'password';
            passwordToggle.textContent = '표시';
        }
    });
    function validateUserInput() {
        const userInput = userInputField.value;
        const phoneRegex = /^(\+?\d{1,3})?[-.\s]?\(?\d{1,4}?\)?[-.\s]?\d{1,4}[-.\s]?\d{1,9}$/;
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;

        if (phoneRegex.test(userInput)) {
            // 입력이 전화번호 형식일 때
            phoneNumberField.value = userInput;
            emailField.value = '';  // 이메일 값 초기화
            userError.textContent = '';
            userError.classList.remove('show');
        } else if (emailRegex.test(userInput)) {
            // 입력이 이메일 형식일 때
            emailField.value = userInput;
            phoneNumberField.value = '';  // 전화번호 값 초기화
            userError.textContent = '';
            userError.classList.remove('show');
        } else {
            // 올바르지 않은 형식일 때
            userError.textContent = '유효한 휴대폰 번호 또는 이메일 주소를 입력하세요.';
            userError.classList.add('show');
            phoneNumberField.value = '';
            emailField.value = '';
        }
    }

    function checkUsername() {
        // 실제로는 서버에 요청을 보내 중복 확인을 해야 합니다.
        // 여기서는 간단한 시뮬레이션만 합니다.
        if (username.value === 'admin' || username.value === 'instagram') {
            usernameError.textContent = '이 사용자 이름은 이미 사용 중입니다.';
            suggestUsernames(username.value);
        } else {
            usernameSuggestions.textContent = '';
        }
    }

    function validatePassword() {
        if (password.value.length < 6) {
            passwordError.textContent = '비밀번호는 6자 이상이어야 합니다.';
        } else {
            passwordError.textContent = '';
        }
    }

    // 전체 폼 유효성 검사
    function validateForm() {
        validateEmail();
        validateUsername();
        validatePassword();
    }

</script>
</body>
</html>